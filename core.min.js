!function(e,c,a,h){var b=XF.Cookie.get("sam_viewed")?JSON.parse(XF.Cookie.get("sam_viewed")):{};var g=null;function f(k){if(!k.length){return}var m=e(c).scrollTop();var l=m+e(c).height();var i=e(k).offset().top;var j=i+e(k).height();return((j<=l)&&(i>=m))}function d(j,i){gtag("event",i,{event_category:"Ads",event_label:j.name+" | "+j.type+" | "+j.position})}e(function(){if(XF.samViewCountMethod=="impression"){var k=[];e(".samItem[data-id][data-cv]").each(function(){var m=e(this).data("id");var l=e(this).data("position")?e(this).data("position"):e(this).parents("div[data-position]").data("position");k.push([m,l])});setTimeout(function(){for(var l in XF.samBgAds){k.push([XF.samBgAds[l],"javascript"])}if(k.length){XF.ajax("POST",XF.canonicalizeUrl("index.php?sam-item/track-impressions"),{impressions:k},function(n){if(n.ga!==undefined&&c.gtag!==undefined){for(var m in n.ga){d(n.ga[m],"Impression")}}},{skipDefault:true,global:false})}},2000);if(e("#siropuChatBar").length){e('div[data-position="footer_fixed"]').each(function(){e(this).css("bottom",e("#siropuChatBar").height()+5)})}}e(".samItem[data-affiliate-url]").on("click",function(n){n.preventDefault();var l=e(this).data("affiliate-url");var m=e(this).attr("target");c.open(l,m?m:"_self")});e(".samItem[data-affiliate-url]").contextmenu(function(l){e(this).attr({href:e(this).data("affiliate-url"),"data-non-affiliate-url":e(this).attr("href")})});e(".samItem[data-affiliate-url]").on("mouseover",function(m){var l=e(this).data("non-affiliate-url");if(l){e(this).attr("href",l)}});e(a).on("mouseover",".samItem iframe",function(){g=e(this).parents(".samItem")});e(a).on("mouseout",".samItem iframe",function(){g=null});e(c).blur(function(){if(g){g.trigger("click")}});e(c).focus(function(){g=null});function i(m){var l=m.match(/[^-]?width:\s?([\d]+)px/i);return l[1]!==undefined?l[1]:""}function j(){e(".samCustomSize").each(function(){var n=e(this).parent();var m=e(this).hasClass("samResponsive");var l=e(this).hasClass("samCarousel");var q=e(this).attr("style");var p=0;if(q){p=i(q)}else{e(this).find(".samItem[style]").each(function(){p=i(e(this).attr("style"));if(p){return false}})}var o=p>=n.width();if(o&&!m){e(this).addClass("samResponsive")}else{if(!o&&m){e(this).removeClass("samResponsive")}}})}e(c).resize(function(){j()});j()});XF.SAMUnit=XF.Element.newHandler({options:{position:""},init:function(){var k=this.$target;var j=k.hasClass("samCarousel");if(j&&!k.hasClass("samCustomSize")){var l=k.parent().data("options");if(l.slidesPerView!==undefined){return}var i=[];k.find(".samItem img[data-src]").on("load",function(){i.push(e(this).width())});k.find(".samItem img:not([data-src])").each(function(){i.push(e(this).width())});setTimeout(function(){var q=Math.max.apply(Math,i);if(q){var n=(k.parent().width()-q);if(n){var p=n/2-25;var m=0;var o=0;if(k.hasClass("samAlignCenter")){m=p;o=p}else{if(k.hasClass("samAlignRight")){m=n;o=0}else{m=0;o=n}}k.parent().find(".swiper-button-prev").css("left",m-5);k.parent().find(".swiper-button-next").css("right",o-5)}}},1000)}}});XF.SAMItem=XF.Element.newHandler({options:{id:0,ha:0,da:0,df:false,cc:false,cv:false,ll:false,rf:0},refreshInterval:false,init:function(){var j=this.$target;if(this.options.cv){j.on("adView",e.proxy(this,"trackView"))}if(this.options.cc){j.on("click",e.proxy(this,"trackClick"))}if(this.options.df){j.on("adJsView",e.proxy(this,"trackJsView"))}j.on("adViewCarousel",function(){if(f(j.parent())){j.trigger("adView",true)}});var i=this;e(c).scroll(function(){var k=j.parent();if(f(k)){if(i.options.da){i.initDelayDisplay()}else{if(!k.hasClass("samCarousel")){j.trigger("adView")}}if(i.options.ha){i.initDelayHide()}if(i.options.df){j.trigger("adJsView")}if(i.options.ll&&!j.attr("data-loading")){i.loadAd()}}});e(c).scroll()},trackView:function(k,l){if(XF.samViewCountMethod!="view"){return}var i=this.$target;var j=this.getPositionId();if(i.data("viewed")||i.is(":hidden")||(i.parents(".samCarousel").length&&!l)){return}XF.ajax("POST",XF.canonicalizeUrl("index.php?sam-item/"+this.options.id+"/track-view"),{position_id:j},function(m){if(m.ga!==undefined&&c.gtag!==undefined){d(m.ga,"View")}},{skipDefault:true,global:false});if(j=="javascript"){e(".samBackgroundItem").attr("data-viewed",true)}else{i.attr("data-viewed",true)}},trackClick:function(n){var j=this.$target;var l=this.getPositionId();var k=l=="javascript"?j:j.find("a");var i="";if(k.data("multiple")){i=k.find("img").attr("src");if(!i){var m=e(".samBackground").css("background-image");i=m.replace("url(","").replace(")","").replace(/\"/gi,"")}}if(j.data("clicked")){return}XF.ajax("POST",XF.canonicalizeUrl("index.php?sam-item/"+this.options.id+"/track-click"),{position_id:l,image_url:i,page_url:(c.location!=c.parent.location)?a.referrer:a.location.href},function(o){if(l=="javascript"){e(".samBackgroundItem").attr("data-clicked",true)}else{j.attr("data-clicked",true)}if(o.ga!==undefined&&c.gtag!==undefined){d(o.ga,"Click")}},{skipDefault:true,global:false})},trackJsView:function(){b[this.options.id]=XF.samServerTime;XF.Cookie.set("sam_viewed",JSON.stringify(b))},initDelayDisplay:function(){var i=this.$target;if(i.is(":visible")||i.data("da-init")){return}i.attr("data-da-init",true);setTimeout(function(){i.fadeIn();i.trigger("adView");i.removeAttr("data-da-init")},this.options.da*1000)},initDelayHide:function(){var j=this.$target;var k=j.parent();if(j.data("ha-init")){return}j.attr("data-ha-init",true);var i=this;setTimeout(function(){j.fadeOut();j.removeAttr("data-ha-init");setTimeout(function(){if(k.find(".samItem:visible").length==0){k.remove()}},500)},(this.options.da+this.options.ha)*1000)},loadAd:function(k){var i=this;var j=this.$target;var l=i.getPositionId();j.attr("data-loading",true);XF.ajax("GET",XF.canonicalizeUrl("index.php?sam-item/"+this.options.id+"/load"),{position_id:l},function(n){if(n.ad){if(i.options.rf){var m=j.find(".samBackup, .samCloseButton, .samSupportUs").detach();j.html(n.ad);j.append(m)}else{j.prepend(n.ad)}if(!k){j.removeClass("samLazyLoading");e(a).trigger("samInitAdblockDetection")}if(i.options.rf&&!i.refreshInterval){i.refreshInterval=setInterval(function(){i.loadAd(true)},i.options.rf)}}},{skipDefault:true,global:false})},getPositionId:function(){var i=this.$target.data("position");switch(i){case"content_thread":case"content_conversation":case"content_profile":case"javascript":return i;break;default:return this.$target.parents("div[data-position]").data("position");break}}});XF.SAMLazy=XF.Element.newHandler({options:{src:"",carousel:false},init:function(){var i=this;var j=this.$target;if(i.options.carousel==false){e(c).scroll(function(){if(j.is(":hidden")&&f(j.parents("div[data-position]"))){i.loadImage()}});e(c).scroll()}this.$target.on("loadImage",e.proxy(this,"loadImage"))},loadImage:function(){this.$target.attr("src",this.options.src).fadeIn("slow").removeAttr("data-src")}});XF.SAMMonitor=XF.Element.newHandler({options:{id:0,cl:1},clickCount:0,init:function(){this.$target.on("click",e.proxy(this,"monitorClick"))},monitorClick:function(){this.clickCount++;if(this.clickCount==this.options.cl){this.remove()}var i=this;XF.ajax("POST",XF.canonicalizeUrl("index.php?sam-item/"+this.options.id+"/monitor-click"),{page_url:(c.location!=c.parent.location)?a.referrer:a.location.href},function(j){if(j.blocked){i.remove();if(j.blockTime!==undefined){XF.Cookie.set("sam_skip",j.blockTime)}}},{skipDefault:true,global:false})},remove:function(){var i=this.$target;var j=i.parent();i.remove();if(!j.find(".samItem").length){j.remove()}}});XF.SAMGa=XF.Element.newHandler({options:{ga:{}},init:function(){var i=this;var j=this.$target;if(c.gtag===undefined){return}if(XF.samViewCountMethod=="impression"){d(this.options.ga,"Impression")}else{e(c).scroll(function(){if(!j.data("viewed")&&f(j.parent())){d(i.options.ga,"View");i.markAsViewed()}})}j.on("click",function(){if(j.data("clicked")){return}d(i.options.ga,"Click");i.markAsClicked()})},markAsViewed:function(){this.$target.attr("data-viewed",true)},markAsClicked:function(){this.$target.attr("data-clicked",true)}});XF.SAMClose=XF.Click.newHandler({eventNameSpace:"SAMClose",options:{},init:function(){},click:function(){var j=this.$target.parents("div[data-position]");j.fadeOut();if(j.data("position")=="over_bb_code_video_attachment"){var i=j.parent();i.find(".samVideoOverlay").fadeOut();i.find("video")[0].play()}}});XF.Element.register("sam-unit","XF.SAMUnit");XF.Element.register("sam-item","XF.SAMItem");XF.Element.register("sam-lazy","XF.SAMLazy");XF.Element.register("sam-monitor","XF.SAMMonitor");XF.Element.register("sam-ga","XF.SAMGa");XF.Click.register("sam-close","XF.SAMClose")}(jQuery,window,document);